{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to my Smart Home! \u00b6 Home Living Room Bedroom Balcony System This is my personal Home Assistant configuration, awakening my home with automations. I hope this will help you inspire on the way to built your own smart home. Beware of changes I constantly improve my home. It evolves as I add new devices and services. It's changing as my daily routines are changing. Please, keep in mind this documentation might be outdated in covering some details. However, I'll try my best to keep this updated. The best way to discover new ideas and inspire is by reading the code , copying-pasting parts of my configuration and adjusting it to your needs. Read this documentation to see the bigger picture: Hardware Software Home Assistant Resources What's inside? \u00b6 My home setup for those who are too lazy to read everything: Raspberry Pi 4B as a home server. Home Assistant for home automations. Mosquitto and zigbee2mqtt for Zigbee devices. Reverse proxy using Nginx Proxy Manager with CloudFlare . OpenVPN for SSH and Samba access. Pi-hole for blocking ads within home network. Plex Media Server with an external hard drive for hosting movies and TV series. Transmission for downloading new media to the hard drive. Vaultwarden for password management (Rust implementation of Bitwarden ). Motivation \u00b6 I write this documentation for two main reasons: To keep track of growing my smart home. To maintain an understanding of how things are working. To help other enthusiasts inspire. People often ask about my smart home setup. Now I can give them a link to this documentation, instead of explaining everything once again. Limitations \u00b6 I'm renting my apartment. My landlord handles fixing stuff in my home, covering all the expenses. The only downside is that I can't change anything in my home. I can't disassemble anything and use custom switches or sockets. It means I can change only easily accessible parts, like bulbs. Future Plans \u00b6 I have a public Notion board with ideas and tasks for my smart home. You can follow and comment my plans there. See future plans License \u00b6 MIT \u00a9 Denys Dovhan","title":"Home"},{"location":"#welcome-to-my-smart-home","text":"Home Living Room Bedroom Balcony System This is my personal Home Assistant configuration, awakening my home with automations. I hope this will help you inspire on the way to built your own smart home. Beware of changes I constantly improve my home. It evolves as I add new devices and services. It's changing as my daily routines are changing. Please, keep in mind this documentation might be outdated in covering some details. However, I'll try my best to keep this updated. The best way to discover new ideas and inspire is by reading the code , copying-pasting parts of my configuration and adjusting it to your needs. Read this documentation to see the bigger picture: Hardware Software Home Assistant Resources","title":"Welcome to my Smart Home!"},{"location":"#whats-inside","text":"My home setup for those who are too lazy to read everything: Raspberry Pi 4B as a home server. Home Assistant for home automations. Mosquitto and zigbee2mqtt for Zigbee devices. Reverse proxy using Nginx Proxy Manager with CloudFlare . OpenVPN for SSH and Samba access. Pi-hole for blocking ads within home network. Plex Media Server with an external hard drive for hosting movies and TV series. Transmission for downloading new media to the hard drive. Vaultwarden for password management (Rust implementation of Bitwarden ).","title":"What's inside?"},{"location":"#motivation","text":"I write this documentation for two main reasons: To keep track of growing my smart home. To maintain an understanding of how things are working. To help other enthusiasts inspire. People often ask about my smart home setup. Now I can give them a link to this documentation, instead of explaining everything once again.","title":"Motivation"},{"location":"#limitations","text":"I'm renting my apartment. My landlord handles fixing stuff in my home, covering all the expenses. The only downside is that I can't change anything in my home. I can't disassemble anything and use custom switches or sockets. It means I can change only easily accessible parts, like bulbs.","title":"Limitations"},{"location":"#future-plans","text":"I have a public Notion board with ideas and tasks for my smart home. You can follow and comment my plans there. See future plans","title":"Future Plans"},{"location":"#license","text":"MIT \u00a9 Denys Dovhan","title":"License"},{"location":"hardware/","text":"Hardware \u00b6 This is the list of the hardware that is present in my smart home. Home Server \u00b6 The heart of my smart home is a home server based on Raspberry Pi 4 Model B with 4GB of RAM onboard. It's a small, affordable, but nonetheless a very capable device. It's held within an aluminum alloy case I bought on AliExpress. The aluminum case itself helps to disperse heat. Additionally, it came with a heat sink set and a tiny cooling fan. Info Home Assistant team recommands to use Application Class 2 as they handle small I/O much more consistently than cards not optimized to host applications. A 32 GB or bigger card is recommended. I use official Raspberry Pi 15W USB-C Power Supply for powering my smart home server. It is important to get enough power for Raspberry Pi to work properly. Home Assistant requires at least 3A power and this power supply cable handles it just right. Home Server Hardware Alluminium Case Assembling Assembled and Connected Here's a photo of my home server hardware, right after I received it: A photo of the aluminum case when I was assembling it: Here's a whole kit assembled and connected to power: Storage \u00b6 I use Kingston SSDNow A400 240GB 2.5\" as a system data storage. It's connected to Raspberry Pi via Ugreen US221 USB 3.0 case adapter. As a media storage I use Transcend StoreJet 25M3 2TB hard drive (which I got from my dad as my birthday present in 2020). Both storages are connecterd via USB 3.0 interface on Raspberry to allow high speed reading, so I can easily stream my media using Plex . Media is downloaded directly to my HDD using Transmission container. SSD and HDD Assembled and Connected SSD whithin a Case HDD Connected Info Previously, I used a SanDisk Extreme Pro MicroSD A2 V30 128GB (previously 64GB). Previous 64GB SD-card served well for more than 2 years. After some time, my server started to shutdown randomly. Power supply was normal, so I decided to update to 128GB card. WiFi Network \u00b6 You're going to have a lot of devices in your network when you have a smart home. It's critical to choose a good router to handle multiple devices and heavy traffic. Wireless Router \u00b6 The second most important thing in my smart home is a WiFi router. I've spent a lot of time choosing the right router . My main requirements for the router were: Dual-band: 2.4GHz and 5GHz \u2014 Primarily, I use two networks in my home: 2.4GHz for smart devices and 5GHz for personal devices like phones and laptops. 5GHz uses shorter radio waves, and that provides faster speeds. MU-MIMO \u2014 This is a technology that enables simultaneous communication to multiple devices, improving overall speed and enabling network multitasking. It is critical when you have lots of connected devices and want each of them to work with the highest speed. 802.11ac \u2014 this is a so-called WiFi5 standard. It allows increased speeds and improved scalability. I have a gigabyte connection at my home and wanted to benefit from it. I chose ASUS RT-AC1750U router for my home. It matches every condition above and has nice additional features. Also, I've noticed that routers by ASUS are quite respected among other smart-home enthusiasts. I'm happy with my decision so far. This router gives the constant 600-900 Mbit/s speed, which is enough to download a 10GB file in less than 2 minutes. Previously, I've also tried Xiaomi Router and wasn't happy about it. Xiaomi Router has UI in Chines and worked unreliably overall. Here are my current ASUS and former Xiaomi routers: Devices \u00b6 Below you will find a list of my devices connected to the local network. Most of them, except for Apple TV, have static IP addresses. Device IP HA Integration Apple TV 4K 192.168.50.x * Apple TV Koogeek P1EU Smart Plug 192.168.50.9 HomeKit Controller Koogeek P1EU Smart Plug 192.168.50.10 HomeKit Controller Koogeek P1EU Smart Plug 192.168.50.11 HomeKit Controller Samsung 55\" Q67R 4K Smart QLED TV 192.168.50.93 ha-samsungtv-tizen ** Raspberry Pi 192.168.50.113 * \u2013 Yeelight LED Bulb 1S (Color) 192.168.50.128 Yeelight Yeelight LED Bulb 1S (Color) 192.168.50.129 Yeelight Xiaomi Bulb White and Color 192.168.50.130 Yeelight Xiaomi Desk Lamp Pro 192.168.50.131 Yeelight PlayStation 4 Pro 192.168.50.185 * Sony PlayStation 4 Roborock S5 Max 192.168.50.186 Xiaomi Miio Deerma Humidifier (mjjsq) 192.168.50.187 xiaomi_airpurifier ** Xiaomi Air Purifier 3H 192.168.50.188 Xiaomi Miio Google Home Mini 192.168.50.220 Google Cast Google Nest Mini 192.168.50.221 Google Cast living-room-ac 192.168.50.x ESPHome bedroom-ac 192.168.50.x ESPHome * \u2014 means the device is connected via Ethernet instead of WiFi to ensure a more reliable connection. ** \u2014 means the device is integrated via custom integration. ESP Devices \u00b6 I use two ESP8266 devices based on iot-uni-dongle for controlling my Midea ACs. Zigbee Network \u00b6 My Zigbee devices are connected to Home Assistant via SMARTLIGHT CC2652P Zigbee USB Adapter SLZB-02 as a coordinator. Devices are controlled by Home Assistant via: zigbee2mqtt + Mosquitto + MQTT Integration . Note Previosly my Zigbee network was working with CC2531 Sniffer Board as a coordinator. It was fine with small amount of devices, but as my network grew I started to get weird behavior . Additioanlly, I've discovered that CC2531 is no longer recommended by zigbee2mqtt developers . Tip I connected my coordinator to the Raspberry Pi through a USB extension cable to avoid interference and improve the connection. This approach is suggested by zigbee2mqtt documentation . I used to use Aqara Hub, but it switched to the current approach because of its compatibility. The current approach allows binding together nearly every possible Zigbee device . Devices \u00b6 Device Quantity Notes Aqara Smart LED Bulb 9W 5 Ceiling and Main lights Aqara Motion Sensor 2 Detecting motions in both rooms Aqara Magic Cube Controller 1 Controlling lights, scenes and modes Aqara Conditions Sensor 1 Internal temperature, humidity and pressure data Aqara Contact Sensor 1 Detection front door opening Aqara Single Switch Module T1 (without neutral) 1 Switching corridor light MiJia Conditions Sensor 1 Internal temperature and humidity data Tuya Smart ZigBee Radiator 2 Adjusting heaters temperature Lonsonho 2-Gang Switch 2 (without neutral) 1 Switching kitchen lights Media Volume \u00b6 I've got a Transcend StoreJet 25M3 2TB hard drive from my dad as my birthday present in 2020. I have this HDD connected to my Raspberry Pi. It is used as a storage for my media files (primarly movies and TV-series). USB 3.0 interface on Raspberry allows high speed reading, so I can easily stream my media using Plex . Media is downloaded directly to my HDD using Transmission container. Other Devices \u00b6 Another important device is a smart car alarm. I used StarLine AS96 BT GSM GPS which is easily integrated with Home Assistant via built-in StarLine integration . This alarm allows to start/stop the engine, arm/disarm the alarm, trigger horn remotely via Home Assistant. Primarily, I use this for tracking down my car and checking interior temperature right from Home Assistant.","title":"Hardware"},{"location":"hardware/#hardware","text":"This is the list of the hardware that is present in my smart home.","title":"Hardware"},{"location":"hardware/#home-server","text":"The heart of my smart home is a home server based on Raspberry Pi 4 Model B with 4GB of RAM onboard. It's a small, affordable, but nonetheless a very capable device. It's held within an aluminum alloy case I bought on AliExpress. The aluminum case itself helps to disperse heat. Additionally, it came with a heat sink set and a tiny cooling fan. Info Home Assistant team recommands to use Application Class 2 as they handle small I/O much more consistently than cards not optimized to host applications. A 32 GB or bigger card is recommended. I use official Raspberry Pi 15W USB-C Power Supply for powering my smart home server. It is important to get enough power for Raspberry Pi to work properly. Home Assistant requires at least 3A power and this power supply cable handles it just right. Home Server Hardware Alluminium Case Assembling Assembled and Connected Here's a photo of my home server hardware, right after I received it: A photo of the aluminum case when I was assembling it: Here's a whole kit assembled and connected to power:","title":"Home Server"},{"location":"hardware/#storage","text":"I use Kingston SSDNow A400 240GB 2.5\" as a system data storage. It's connected to Raspberry Pi via Ugreen US221 USB 3.0 case adapter. As a media storage I use Transcend StoreJet 25M3 2TB hard drive (which I got from my dad as my birthday present in 2020). Both storages are connecterd via USB 3.0 interface on Raspberry to allow high speed reading, so I can easily stream my media using Plex . Media is downloaded directly to my HDD using Transmission container. SSD and HDD Assembled and Connected SSD whithin a Case HDD Connected Info Previously, I used a SanDisk Extreme Pro MicroSD A2 V30 128GB (previously 64GB). Previous 64GB SD-card served well for more than 2 years. After some time, my server started to shutdown randomly. Power supply was normal, so I decided to update to 128GB card.","title":"Storage"},{"location":"hardware/#wifi-network","text":"You're going to have a lot of devices in your network when you have a smart home. It's critical to choose a good router to handle multiple devices and heavy traffic.","title":"WiFi Network"},{"location":"hardware/#wireless-router","text":"The second most important thing in my smart home is a WiFi router. I've spent a lot of time choosing the right router . My main requirements for the router were: Dual-band: 2.4GHz and 5GHz \u2014 Primarily, I use two networks in my home: 2.4GHz for smart devices and 5GHz for personal devices like phones and laptops. 5GHz uses shorter radio waves, and that provides faster speeds. MU-MIMO \u2014 This is a technology that enables simultaneous communication to multiple devices, improving overall speed and enabling network multitasking. It is critical when you have lots of connected devices and want each of them to work with the highest speed. 802.11ac \u2014 this is a so-called WiFi5 standard. It allows increased speeds and improved scalability. I have a gigabyte connection at my home and wanted to benefit from it. I chose ASUS RT-AC1750U router for my home. It matches every condition above and has nice additional features. Also, I've noticed that routers by ASUS are quite respected among other smart-home enthusiasts. I'm happy with my decision so far. This router gives the constant 600-900 Mbit/s speed, which is enough to download a 10GB file in less than 2 minutes. Previously, I've also tried Xiaomi Router and wasn't happy about it. Xiaomi Router has UI in Chines and worked unreliably overall. Here are my current ASUS and former Xiaomi routers:","title":"Wireless Router"},{"location":"hardware/#devices","text":"Below you will find a list of my devices connected to the local network. Most of them, except for Apple TV, have static IP addresses. Device IP HA Integration Apple TV 4K 192.168.50.x * Apple TV Koogeek P1EU Smart Plug 192.168.50.9 HomeKit Controller Koogeek P1EU Smart Plug 192.168.50.10 HomeKit Controller Koogeek P1EU Smart Plug 192.168.50.11 HomeKit Controller Samsung 55\" Q67R 4K Smart QLED TV 192.168.50.93 ha-samsungtv-tizen ** Raspberry Pi 192.168.50.113 * \u2013 Yeelight LED Bulb 1S (Color) 192.168.50.128 Yeelight Yeelight LED Bulb 1S (Color) 192.168.50.129 Yeelight Xiaomi Bulb White and Color 192.168.50.130 Yeelight Xiaomi Desk Lamp Pro 192.168.50.131 Yeelight PlayStation 4 Pro 192.168.50.185 * Sony PlayStation 4 Roborock S5 Max 192.168.50.186 Xiaomi Miio Deerma Humidifier (mjjsq) 192.168.50.187 xiaomi_airpurifier ** Xiaomi Air Purifier 3H 192.168.50.188 Xiaomi Miio Google Home Mini 192.168.50.220 Google Cast Google Nest Mini 192.168.50.221 Google Cast living-room-ac 192.168.50.x ESPHome bedroom-ac 192.168.50.x ESPHome * \u2014 means the device is connected via Ethernet instead of WiFi to ensure a more reliable connection. ** \u2014 means the device is integrated via custom integration.","title":"Devices"},{"location":"hardware/#esp-devices","text":"I use two ESP8266 devices based on iot-uni-dongle for controlling my Midea ACs.","title":"ESP Devices"},{"location":"hardware/#zigbee-network","text":"My Zigbee devices are connected to Home Assistant via SMARTLIGHT CC2652P Zigbee USB Adapter SLZB-02 as a coordinator. Devices are controlled by Home Assistant via: zigbee2mqtt + Mosquitto + MQTT Integration . Note Previosly my Zigbee network was working with CC2531 Sniffer Board as a coordinator. It was fine with small amount of devices, but as my network grew I started to get weird behavior . Additioanlly, I've discovered that CC2531 is no longer recommended by zigbee2mqtt developers . Tip I connected my coordinator to the Raspberry Pi through a USB extension cable to avoid interference and improve the connection. This approach is suggested by zigbee2mqtt documentation . I used to use Aqara Hub, but it switched to the current approach because of its compatibility. The current approach allows binding together nearly every possible Zigbee device .","title":"Zigbee Network"},{"location":"hardware/#devices_1","text":"Device Quantity Notes Aqara Smart LED Bulb 9W 5 Ceiling and Main lights Aqara Motion Sensor 2 Detecting motions in both rooms Aqara Magic Cube Controller 1 Controlling lights, scenes and modes Aqara Conditions Sensor 1 Internal temperature, humidity and pressure data Aqara Contact Sensor 1 Detection front door opening Aqara Single Switch Module T1 (without neutral) 1 Switching corridor light MiJia Conditions Sensor 1 Internal temperature and humidity data Tuya Smart ZigBee Radiator 2 Adjusting heaters temperature Lonsonho 2-Gang Switch 2 (without neutral) 1 Switching kitchen lights","title":"Devices"},{"location":"hardware/#media-volume","text":"I've got a Transcend StoreJet 25M3 2TB hard drive from my dad as my birthday present in 2020. I have this HDD connected to my Raspberry Pi. It is used as a storage for my media files (primarly movies and TV-series). USB 3.0 interface on Raspberry allows high speed reading, so I can easily stream my media using Plex . Media is downloaded directly to my HDD using Transmission container.","title":"Media Volume"},{"location":"hardware/#other-devices","text":"Another important device is a smart car alarm. I used StarLine AS96 BT GSM GPS which is easily integrated with Home Assistant via built-in StarLine integration . This alarm allows to start/stop the engine, arm/disarm the alarm, trigger horn remotely via Home Assistant. Primarily, I use this for tracking down my car and checking interior temperature right from Home Assistant.","title":"Other Devices"},{"location":"resources/","text":"Resources \u00b6 On this page, I'm trying to collect useful resources I used to improve my home: Configurations \u00b6 MacBury Smart House very cool and complex setup. I was inspired a lot by this. Frenck's Home Assistant Configuration unusual folder structure. Articles \u00b6 How I set up room-cleaning automation with Google Home, Home-Assistant and Xiaomi vacuum cleaner Actionable Notifications for Home Assistant Docker Compose MariaDB Multiple Database about provisioning MariaDB databases. YouTube Channels \u00b6 JuanMTech YouTube Channel about general Home Assistant setup. Very high-quality videos. Zack Barett YouTube Channel mostly about Lovelace UI configuration and new Home Assistant features. DrZzs YouTube Channel about almost every possible smart-home related stuff. His hovering talking head might look a bit weird and even creepy, but the content itself is very useful. Grayson Adams about devices overview, basic Home Assistant setup. DB Tech generally about server administration. Mostly about Docker, Portainer, self-hosted services, OpenMediaVault, and Raspberry Pi. Very high-quality videos. YouTube Videos \u00b6 Raspberry Pi 4 Home Server playlist by DB Tech is specifically about smart-home hosted on Raspberry Pi. Super Simple Cloudflare and Nginx Proxy Manager Setup Using YOUR Domain by Geeked CloudFlare - FREE Additional Security For Your Home Server! by DB Tech Misc \u00b6 Awesome Home Assistant for general links related to Home Assistant Home Assistant Twitter for news and community interactions","title":"Resources"},{"location":"resources/#resources","text":"On this page, I'm trying to collect useful resources I used to improve my home:","title":"Resources"},{"location":"resources/#configurations","text":"MacBury Smart House very cool and complex setup. I was inspired a lot by this. Frenck's Home Assistant Configuration unusual folder structure.","title":"Configurations"},{"location":"resources/#articles","text":"How I set up room-cleaning automation with Google Home, Home-Assistant and Xiaomi vacuum cleaner Actionable Notifications for Home Assistant Docker Compose MariaDB Multiple Database about provisioning MariaDB databases.","title":"Articles"},{"location":"resources/#youtube-channels","text":"JuanMTech YouTube Channel about general Home Assistant setup. Very high-quality videos. Zack Barett YouTube Channel mostly about Lovelace UI configuration and new Home Assistant features. DrZzs YouTube Channel about almost every possible smart-home related stuff. His hovering talking head might look a bit weird and even creepy, but the content itself is very useful. Grayson Adams about devices overview, basic Home Assistant setup. DB Tech generally about server administration. Mostly about Docker, Portainer, self-hosted services, OpenMediaVault, and Raspberry Pi. Very high-quality videos.","title":"YouTube Channels"},{"location":"resources/#youtube-videos","text":"Raspberry Pi 4 Home Server playlist by DB Tech is specifically about smart-home hosted on Raspberry Pi. Super Simple Cloudflare and Nginx Proxy Manager Setup Using YOUR Domain by Geeked CloudFlare - FREE Additional Security For Your Home Server! by DB Tech","title":"YouTube Videos"},{"location":"resources/#misc","text":"Awesome Home Assistant for general links related to Home Assistant Home Assistant Twitter for news and community interactions","title":"Misc"},{"location":"home-assistant/custom-extensions/","text":"Custom Extensions \u00b6 Home Assistant has a lot of integrations, but sometimes it's not enough. Fortunately, Home Assistant provides a way to add external integrations. Below you will find integrations and Lovelace cards developed by me and by other smart-home enthusiasts . I use HACS for managing my third-party integrations and cards. Developed by Me \u00b6 Sometimes even extensions provided by HACS are not enough, so I had to develop some extensions by myself. Lovelace Cards \u00b6 vacuum-card \u00b6 By default, Home Assistant does not provide any card for controlling vacuum cleaners. This card displays the state and allows you to control your robot. purifier-card \u00b6 As for vacuums, Home Assistant doesn't provide any card for controlling air purifiers either. This card displays the state and allows to control your air purifier. Third party \u00b6 Here's a list of extensions developed by other developers. Lovelace Cards \u00b6 mini-media-player \u2014 The default one looks not so elegant and has way fewer options to display. mini-graph-card \u2014 This one has a ton of different options. The killer feature for me: the ability to animate and display multiple graphs. mini-humidifier \u2014 Simple and minimalistic. Default humidifier card allows displaying humidifiers only from humidifier domain, whereas my humidifier is available under fan domain. I don't actually like this card and plan to make my own to match the design of vacuum and purifier cards. lovelace-xiaomi-vacuum-map-card \u2014 This card enables you to specify a target or start a zoned cleanup using a live or static map, just like in Xiaomi Home app. Additionally you can define a list of zones and choose the ones to be cleaned. state-switch \u2014 This card is like a usual conditional card, but allows to make conditions based on the current user. I used this only to display appropriate Spotify player in Lovelace. bar-card \u2014 This card is design to display progress bars. transmission-card \u2014 This card is for displaying controls over Transmission torrent client. Integrations \u00b6 HACS (Home Assistant Community Store) \u2014 A store for easier management of custom_components . Xiaomi Cloud Map Extractor \u2014 This custom integration provides a way to present a live view of a map for a Xiaomi (and Roborock) vacuums. Adaptive Lighting \u2014 Adaptive Lighting slowly synchronizes your color-changing lights with the regular naturally occurring color temperature of the sky throughout the day. This gives your environment a more natural feel, with cooler hues during the midday and warmer tints near twilight and dawn. Built-in flux integration is very limited and bold. Car Wash \u2014 This component checks the weather forecast for several days in advance and concludes whether it is worth washing the car now. Snowtire \u2014 This component checks the weather forecast for several days in advance and concludes whether it is time to change car tires from summer to winter and vice versa. Powercalc \u2014 This component calculates estimated power consumption of lights and other appliances. This allows to make use of Energy dashboard even when you don't have smart electricity meters. Presence Simulation \u2014 This component looks for history of devices and simulates the history with a random shift. Very useful to simulate presence at home when we are away.","title":"Custom Extensions"},{"location":"home-assistant/custom-extensions/#custom-extensions","text":"Home Assistant has a lot of integrations, but sometimes it's not enough. Fortunately, Home Assistant provides a way to add external integrations. Below you will find integrations and Lovelace cards developed by me and by other smart-home enthusiasts . I use HACS for managing my third-party integrations and cards.","title":"Custom Extensions"},{"location":"home-assistant/custom-extensions/#developed-by-me","text":"Sometimes even extensions provided by HACS are not enough, so I had to develop some extensions by myself.","title":"Developed by Me"},{"location":"home-assistant/custom-extensions/#lovelace-cards","text":"","title":"Lovelace Cards"},{"location":"home-assistant/custom-extensions/#vacuum-card","text":"By default, Home Assistant does not provide any card for controlling vacuum cleaners. This card displays the state and allows you to control your robot.","title":"vacuum-card"},{"location":"home-assistant/custom-extensions/#purifier-card","text":"As for vacuums, Home Assistant doesn't provide any card for controlling air purifiers either. This card displays the state and allows to control your air purifier.","title":"purifier-card"},{"location":"home-assistant/custom-extensions/#third-party","text":"Here's a list of extensions developed by other developers.","title":"Third party"},{"location":"home-assistant/custom-extensions/#lovelace-cards_1","text":"mini-media-player \u2014 The default one looks not so elegant and has way fewer options to display. mini-graph-card \u2014 This one has a ton of different options. The killer feature for me: the ability to animate and display multiple graphs. mini-humidifier \u2014 Simple and minimalistic. Default humidifier card allows displaying humidifiers only from humidifier domain, whereas my humidifier is available under fan domain. I don't actually like this card and plan to make my own to match the design of vacuum and purifier cards. lovelace-xiaomi-vacuum-map-card \u2014 This card enables you to specify a target or start a zoned cleanup using a live or static map, just like in Xiaomi Home app. Additionally you can define a list of zones and choose the ones to be cleaned. state-switch \u2014 This card is like a usual conditional card, but allows to make conditions based on the current user. I used this only to display appropriate Spotify player in Lovelace. bar-card \u2014 This card is design to display progress bars. transmission-card \u2014 This card is for displaying controls over Transmission torrent client.","title":"Lovelace Cards"},{"location":"home-assistant/custom-extensions/#integrations","text":"HACS (Home Assistant Community Store) \u2014 A store for easier management of custom_components . Xiaomi Cloud Map Extractor \u2014 This custom integration provides a way to present a live view of a map for a Xiaomi (and Roborock) vacuums. Adaptive Lighting \u2014 Adaptive Lighting slowly synchronizes your color-changing lights with the regular naturally occurring color temperature of the sky throughout the day. This gives your environment a more natural feel, with cooler hues during the midday and warmer tints near twilight and dawn. Built-in flux integration is very limited and bold. Car Wash \u2014 This component checks the weather forecast for several days in advance and concludes whether it is worth washing the car now. Snowtire \u2014 This component checks the weather forecast for several days in advance and concludes whether it is time to change car tires from summer to winter and vice versa. Powercalc \u2014 This component calculates estimated power consumption of lights and other appliances. This allows to make use of Energy dashboard even when you don't have smart electricity meters. Presence Simulation \u2014 This component looks for history of devices and simulates the history with a random shift. Very useful to simulate presence at home when we are away.","title":"Integrations"},{"location":"home-assistant/dashboards/","text":"Dashboards \u00b6 Below you're going to find my dashboards. I use those to display information and control accessories in my smart home. Warning I constantly update my smart home setup and tweaking UI to match my needs. Please, beware that the look of these dashboards on screenshots might differ from how they actually look right now. Please, visit the repo to see the current state of these dashboards. I use mini-media-player card for the media players and mini-graph-card for the graphs. Home \u00b6 This dashboard displays the information about my home in general. Scene controls of the scenes are located at the beginning of the dashboard to be accessible on the phone right away. Room buttons navigate to the room dashboards on the press, and turn off all lights in the room on hold. Media block helps to control my smart speakers and Spotify. Conditions contain information about the weather, indoor temperature, humidity, and pressure, UV-index outdoors, and AQI indoor as well as outdoor (from the nearby AQI station). Status display the information about our location, phone battery, and travel history for the last hours. Living Room \u00b6 This dashboard controls the living room. Lights section controls all smart lights in this room. Media displays the information about my media players (Apple TV, Samsung TV, PS4, Google Nest Mini). Condition shows the current conditions in this room (climate, temperature, humidity, motion) and controls the air purifier via purifier-card . Bedroom \u00b6 This dashboard is for Bedroom related devices. Lights section controls all smart lights in this room. Media controls Google Home Mini smart speaker. Condition shows the current conditions in this room (temperature, humidity, motion) and controls the air humidifier via mini-humidifier . Balcony \u00b6 This dashboard is for the Balcony. I use the Balcony as my workplace. Lights section controls all smart lights in this room. Media displays the information about my Spotify player. Vacuum \u00b6 This dashboard is for controlling a vacuum cleaner robot. Vacuum card for controlling a vacuum cleaner and scrips for quick access to the vacuum, which is hidden under the bed. I developed my own vacuum-card for vacuum management. A map for displaying the current position of the vacuum in my home. The map is blurred. I use lovelace-xiaomi-vacuum-map-car for displaying a live map, though vacuum-card is also capable of displaying live maps. Car \u00b6 This dashboard lets me control my Toyota vehicle. Alarm controls let my arm/disarm my smart alarm, start/stop the engine, trigger horn. History map display the 24-hour path history of the vehicle. States are displaying the sensor states of the hood, doors, trunk, engine and interior temperature, connection quality. Info You may see that most of the controls and sensors are unavailable on the screenshots. That's because I keep my car in the underground parking, where the GSM connection is poor. Though, there's no need to worry, since the parking is secured with many security systems. City \u00b6 This dashboard is created for monitoring city conditions. Air Quality displays AQI in my neighbourhood and Kyiv average, PM2.5 concentration indoor/outdoor and AQI map. Traffic displays realtime traffic map, congestion and traveltime to/from city center. Observation \u00b6 This dashboard displays status of my plants, position of the sun, etc. Cameras \u00b6 This dashboard lets me watch the live streams from Kyiv (where I live) and from Chernivtsi (where I've grown up). Unfortunately, there is a very small number of publicly accessible live cameras in Kyiv. Most of them are unstable and have very poor quality. System \u00b6 This dashboard lets me overview the state of my smart home SystemHealthRegistration Internet and System section displays the Internet speed, ping, and connected devices. Below there are a group of sensor for CPU, RAM, Swap and Disk usage of my Raspberry Pi. Adguard Home let me monitor the DNS ad-blocking rates.","title":"Dashboards"},{"location":"home-assistant/dashboards/#dashboards","text":"Below you're going to find my dashboards. I use those to display information and control accessories in my smart home. Warning I constantly update my smart home setup and tweaking UI to match my needs. Please, beware that the look of these dashboards on screenshots might differ from how they actually look right now. Please, visit the repo to see the current state of these dashboards. I use mini-media-player card for the media players and mini-graph-card for the graphs.","title":"Dashboards"},{"location":"home-assistant/dashboards/#home","text":"This dashboard displays the information about my home in general. Scene controls of the scenes are located at the beginning of the dashboard to be accessible on the phone right away. Room buttons navigate to the room dashboards on the press, and turn off all lights in the room on hold. Media block helps to control my smart speakers and Spotify. Conditions contain information about the weather, indoor temperature, humidity, and pressure, UV-index outdoors, and AQI indoor as well as outdoor (from the nearby AQI station). Status display the information about our location, phone battery, and travel history for the last hours.","title":"Home"},{"location":"home-assistant/dashboards/#living-room","text":"This dashboard controls the living room. Lights section controls all smart lights in this room. Media displays the information about my media players (Apple TV, Samsung TV, PS4, Google Nest Mini). Condition shows the current conditions in this room (climate, temperature, humidity, motion) and controls the air purifier via purifier-card .","title":"Living Room"},{"location":"home-assistant/dashboards/#bedroom","text":"This dashboard is for Bedroom related devices. Lights section controls all smart lights in this room. Media controls Google Home Mini smart speaker. Condition shows the current conditions in this room (temperature, humidity, motion) and controls the air humidifier via mini-humidifier .","title":"Bedroom"},{"location":"home-assistant/dashboards/#balcony","text":"This dashboard is for the Balcony. I use the Balcony as my workplace. Lights section controls all smart lights in this room. Media displays the information about my Spotify player.","title":"Balcony"},{"location":"home-assistant/dashboards/#vacuum","text":"This dashboard is for controlling a vacuum cleaner robot. Vacuum card for controlling a vacuum cleaner and scrips for quick access to the vacuum, which is hidden under the bed. I developed my own vacuum-card for vacuum management. A map for displaying the current position of the vacuum in my home. The map is blurred. I use lovelace-xiaomi-vacuum-map-car for displaying a live map, though vacuum-card is also capable of displaying live maps.","title":"Vacuum"},{"location":"home-assistant/dashboards/#car","text":"This dashboard lets me control my Toyota vehicle. Alarm controls let my arm/disarm my smart alarm, start/stop the engine, trigger horn. History map display the 24-hour path history of the vehicle. States are displaying the sensor states of the hood, doors, trunk, engine and interior temperature, connection quality. Info You may see that most of the controls and sensors are unavailable on the screenshots. That's because I keep my car in the underground parking, where the GSM connection is poor. Though, there's no need to worry, since the parking is secured with many security systems.","title":"Car"},{"location":"home-assistant/dashboards/#city","text":"This dashboard is created for monitoring city conditions. Air Quality displays AQI in my neighbourhood and Kyiv average, PM2.5 concentration indoor/outdoor and AQI map. Traffic displays realtime traffic map, congestion and traveltime to/from city center.","title":"City"},{"location":"home-assistant/dashboards/#observation","text":"This dashboard displays status of my plants, position of the sun, etc.","title":"Observation"},{"location":"home-assistant/dashboards/#cameras","text":"This dashboard lets me watch the live streams from Kyiv (where I live) and from Chernivtsi (where I've grown up). Unfortunately, there is a very small number of publicly accessible live cameras in Kyiv. Most of them are unstable and have very poor quality.","title":"Cameras"},{"location":"home-assistant/dashboards/#system","text":"This dashboard lets me overview the state of my smart home SystemHealthRegistration Internet and System section displays the Internet speed, ping, and connected devices. Below there are a group of sensor for CPU, RAM, Swap and Disk usage of my Raspberry Pi. Adguard Home let me monitor the DNS ad-blocking rates.","title":"System"},{"location":"home-assistant/health-checks/","text":"Health Checks \u00b6 Things will break, this is a matter of time. The electricity outage, crashes, interference, etc. You just must be prepared. Home Assistant Instance \u00b6 I use HealthChecks.io service no notify me when my Home Assistant instance is down (critical crash, an Internet connection is lost, etc). This service is dead-simple: it expects you to send requests at the specified time. As long as requests are received, everything is considered to be normal. When HealthChecks doesn't receive a request at the specified time, it will send me alerts via SMS. Why SMS? Because Home Assistant is offline and can't send me a notification via Internet, so SMS is the only reliable option. I've made a rest_command to send a request to HealthChecks: rest_command : healthcheck : url : !secret healthcheck_ping Automation to send a request every minute: - id : healthcheck alias : Healthcheck Connection description : Send a ping to Healthcheck every minute mode : single trigger : platform : time_pattern minutes : /1 action : - service : rest_command.healthcheck Unavailable Devices \u00b6 Sometimes, my devices go offline when Home Assistant is updating or restarting for a long time. I made a sensor that checks the number of devices for unavailable , unknown , or none states. This sensor also includes their entity_id s and friendly_names to use in automation. - platform : template sensors : unavailable_devices : friendly_name : Unavailable Devices value_template : >- {% set domains = [states.light, states.media_player, states.fan] %} {% set states = ['unavailable', 'unknown', 'none'] %} {{ expand(domains) | selectattr('state', 'in', states) | list | length }} attribute_templates : entities : >- {% set domains = [states.light, states.media_player, states.fan] %} {% set states = ['unavailable', 'unknown', 'none'] %} {{ expand(domains) | selectattr('state', 'in', states) | map(attribute='entity_id') | list }} entities_names : >- {% set domains = [states.light, states.media_player, states.fan] %} {% set states = ['unavailable', 'unknown', 'none'] %} {{ expand(domains) | selectattr('state', 'in', states) | map(attribute='name') | list }} This is automation that sends an alert every time there's more that 0 unavailable devices. - id : unavailable_devices_notifications alias : Unavailable Devices Alert trigger : platform : numeric_state entity_id : sensor.unavailable_devices above : 0 for : minutes : 1 action : # Notify yourself about these devices","title":"Health Checks"},{"location":"home-assistant/health-checks/#health-checks","text":"Things will break, this is a matter of time. The electricity outage, crashes, interference, etc. You just must be prepared.","title":"Health Checks"},{"location":"home-assistant/health-checks/#home-assistant-instance","text":"I use HealthChecks.io service no notify me when my Home Assistant instance is down (critical crash, an Internet connection is lost, etc). This service is dead-simple: it expects you to send requests at the specified time. As long as requests are received, everything is considered to be normal. When HealthChecks doesn't receive a request at the specified time, it will send me alerts via SMS. Why SMS? Because Home Assistant is offline and can't send me a notification via Internet, so SMS is the only reliable option. I've made a rest_command to send a request to HealthChecks: rest_command : healthcheck : url : !secret healthcheck_ping Automation to send a request every minute: - id : healthcheck alias : Healthcheck Connection description : Send a ping to Healthcheck every minute mode : single trigger : platform : time_pattern minutes : /1 action : - service : rest_command.healthcheck","title":"Home Assistant Instance"},{"location":"home-assistant/health-checks/#unavailable-devices","text":"Sometimes, my devices go offline when Home Assistant is updating or restarting for a long time. I made a sensor that checks the number of devices for unavailable , unknown , or none states. This sensor also includes their entity_id s and friendly_names to use in automation. - platform : template sensors : unavailable_devices : friendly_name : Unavailable Devices value_template : >- {% set domains = [states.light, states.media_player, states.fan] %} {% set states = ['unavailable', 'unknown', 'none'] %} {{ expand(domains) | selectattr('state', 'in', states) | list | length }} attribute_templates : entities : >- {% set domains = [states.light, states.media_player, states.fan] %} {% set states = ['unavailable', 'unknown', 'none'] %} {{ expand(domains) | selectattr('state', 'in', states) | map(attribute='entity_id') | list }} entities_names : >- {% set domains = [states.light, states.media_player, states.fan] %} {% set states = ['unavailable', 'unknown', 'none'] %} {{ expand(domains) | selectattr('state', 'in', states) | map(attribute='name') | list }} This is automation that sends an alert every time there's more that 0 unavailable devices. - id : unavailable_devices_notifications alias : Unavailable Devices Alert trigger : platform : numeric_state entity_id : sensor.unavailable_devices above : 0 for : minutes : 1 action : # Notify yourself about these devices","title":"Unavailable Devices"},{"location":"home-assistant/introduction/","text":"Introduction \u00b6 I use Home Assistant as my primary smart home software. It allows me to tied down every separate ecosystem, every device, and every service together. This is a very powerful tool, allowing to built complex and smart automation based on multiple triggers and conditions, performing different actions. So far, I'm happy with Home Assistant and strongly recommend trying it if you are a smart home enthusiast. Prior Art \u00b6 I began my smart home journey with an Aqara Hub and a few bulbs. In the beginning, I was hoping to consolidate my smart home over HomeKit, because I'd already had a few Apple devices. Shortly after, I run into multiple limitations. After a year of using Aqara setup, I decided to switch to the more universal and powerful solution \u2014 Home Assistant . Now I easily pass my devices to the HomeKit as well as to the Google Home app. How I make my automations \u00b6 Tip I highly suggest reading a blog post called Perfect Home Automation written by Home Assistant creator Paulus Schoutsen. This article contains valid points about developing home automation. This will help you develop the right mindset while building your smart home. There are a few rules I use while building my smart home: You should not adapt to technologies. Things should just work . You shouldn't break your own daily routines in order to adapt to your home. Home automation should blend with your current workflow, not replace it. You are not the only user of your home automation. Even when you live alone, you may have guests. Think about how they're going to use your home. Limit the impact of failures. Smart homes are complex: eventually, things will go wrong. Make sure things will have a limited impact when they fail. Ideally, devices should fall back to a pre-smart home experience. Automations must be seamless. Nobody controls lights from the phone except for showing off. This means that everything you automate has to work flawlessly. Even when automation works perfectly 90% of the time, the rest 10% will ruin the whole positive experience. That's what I keep in mind. This helps a lot. Device Tracking \u00b6 Presence detection is done by combination of two components: ASUSWRT and Mobile App . ASUSWRT connects to my ASUS router and checks, if any of family members phones is connected to WiFi. Mobile App tracks our phone locations when we are not home. This integration also provides muscles info, like battery levels.","title":"Introduction"},{"location":"home-assistant/introduction/#introduction","text":"I use Home Assistant as my primary smart home software. It allows me to tied down every separate ecosystem, every device, and every service together. This is a very powerful tool, allowing to built complex and smart automation based on multiple triggers and conditions, performing different actions. So far, I'm happy with Home Assistant and strongly recommend trying it if you are a smart home enthusiast.","title":"Introduction"},{"location":"home-assistant/introduction/#prior-art","text":"I began my smart home journey with an Aqara Hub and a few bulbs. In the beginning, I was hoping to consolidate my smart home over HomeKit, because I'd already had a few Apple devices. Shortly after, I run into multiple limitations. After a year of using Aqara setup, I decided to switch to the more universal and powerful solution \u2014 Home Assistant . Now I easily pass my devices to the HomeKit as well as to the Google Home app.","title":"Prior Art"},{"location":"home-assistant/introduction/#how-i-make-my-automations","text":"Tip I highly suggest reading a blog post called Perfect Home Automation written by Home Assistant creator Paulus Schoutsen. This article contains valid points about developing home automation. This will help you develop the right mindset while building your smart home. There are a few rules I use while building my smart home: You should not adapt to technologies. Things should just work . You shouldn't break your own daily routines in order to adapt to your home. Home automation should blend with your current workflow, not replace it. You are not the only user of your home automation. Even when you live alone, you may have guests. Think about how they're going to use your home. Limit the impact of failures. Smart homes are complex: eventually, things will go wrong. Make sure things will have a limited impact when they fail. Ideally, devices should fall back to a pre-smart home experience. Automations must be seamless. Nobody controls lights from the phone except for showing off. This means that everything you automate has to work flawlessly. Even when automation works perfectly 90% of the time, the rest 10% will ruin the whole positive experience. That's what I keep in mind. This helps a lot.","title":"How I make my automations"},{"location":"home-assistant/introduction/#device-tracking","text":"Presence detection is done by combination of two components: ASUSWRT and Mobile App . ASUSWRT connects to my ASUS router and checks, if any of family members phones is connected to WiFi. Mobile App tracks our phone locations when we are not home. This integration also provides muscles info, like battery levels.","title":"Device Tracking"},{"location":"home-assistant/speech/","text":"Speech \u00b6 I do most of the interactions with my smart home using my voice. This page describes my voice control setup. Home Speakers \u00b6 None of the existing smart speakers supports the Ukrainian language (my native and primary language). I used English (US) for my devices. I have two Google smart speakers. I've decided to go with Google because Google Assistant is smart enough and well-integrated with different accessories. We use these speakers all the time, mostly asking to turn devices, activate scenes, start or stop vacuum, set timers or reminders. Besides, lack of Ukrainian language support, I'm pretty happy with these speakers. Sometimes I need to repeat my command twice for the speaker to pick up, but I consider it acceptable. Google Home Mini Google Nest Mini I got this one as a gift for New Year 2020. This one I got as a gift for my birthday. Text to Speech \u00b6 I wanted to receive voice announcements for my smart home in Ukrainian. Fortunately, Google Translate TTS supports voice generation for the Ukrainian language. tts : - platform : google_translate service_name : google_say language : uk # Ukrainian base_url : !secret external_url This will generate phrases and send them to any speaker to play. Announcements \u00b6 I built a nice announcements script for myself. I use it like this: service : script.announcement data : # Speak on smart speakers speak : true # Send notifications on devices notify : true # Title for notification title : '\u041c\u0438\u0442\u0442\u044f \u0430\u0432\u0442\u043e \ud83d\ude98\u2600\ufe0f' # Opening phrases greetings : - '\u041d\u0430\u0439\u0431\u043b\u0438\u0436\u0447\u0438\u043c\u0438 \u0434\u043d\u044f\u043c\u0438 \u043e\u0447\u0456\u043a\u0443\u0454\u0442\u044c\u0441\u044f \u0445\u043e\u0440\u043e\u0448\u0430 \u043f\u043e\u0433\u043e\u0434\u0430.' - '\u0425\u043e\u0440\u043e\u0448\u0430 \u043f\u043e\u0433\u043e\u0434\u0430 \u043d\u0430\u0439\u0431\u043b\u0438\u0436\u0447\u0456 7 \u0434\u043d\u0456\u0432.' - '\u041f\u0440\u043e\u0433\u043d\u043e\u0437\u0443\u0454\u0442\u044c\u0441\u044f \u0445\u043e\u0440\u043e\u0448\u0430 \u043f\u043e\u0433\u043e\u0434\u0430!' # Main phrases messages : - '\u0414\u043e\u0440\u0435\u0447\u043d\u043e \u043f\u043e\u043c\u0438\u0442\u0438 \u043c\u0430\u0448\u0438\u043d\u0443.' - '\u0412\u0430\u0440\u0442\u043e \u043f\u043e\u0457\u0445\u0430\u0442\u0438 \u043d\u0430 \u0430\u0432\u0442\u043e\u043c\u0438\u0439\u043a\u0443.' - '\u0412\u0434\u0430\u043b\u0438\u0439 \u0447\u0430\u0441, \u0449\u043e\u0431 \u043f\u043e\u043c\u0438\u0442\u0438 \u0430\u0432\u0442\u043e.' # Additional data for notifications # Categories or page to open on notification opening notify_data : url : /lovelace/car This script will generate a unique announcement using random phrases from greetings and messages . The generated phrase will be spoken on smart speakers and sent as a notification to the phones. I can avoid speaking or notifying via speak and notify flags accordingly. notify_data helps to pass notification categories for actionable notifications or url to open when I click on this notification. Speech Scripts Do Not Disturb Flow \u00b6 It would be annoying to get a speech announcement in the middle of the night or a working meeting. That's why I built Do Not Disturb mode. Do Not Disturb is just automation that: Sets the volume of smarts speakers Turns on/off silence modes for fans Turns on/off led indicators Stops/starts voice announcements \u2026 based on the current time of day (sleeping or activity time) and a switch, I can toggle whenever I want. Do Not Disturb Automations","title":"Speech"},{"location":"home-assistant/speech/#speech","text":"I do most of the interactions with my smart home using my voice. This page describes my voice control setup.","title":"Speech"},{"location":"home-assistant/speech/#home-speakers","text":"None of the existing smart speakers supports the Ukrainian language (my native and primary language). I used English (US) for my devices. I have two Google smart speakers. I've decided to go with Google because Google Assistant is smart enough and well-integrated with different accessories. We use these speakers all the time, mostly asking to turn devices, activate scenes, start or stop vacuum, set timers or reminders. Besides, lack of Ukrainian language support, I'm pretty happy with these speakers. Sometimes I need to repeat my command twice for the speaker to pick up, but I consider it acceptable. Google Home Mini Google Nest Mini I got this one as a gift for New Year 2020. This one I got as a gift for my birthday.","title":"Home Speakers"},{"location":"home-assistant/speech/#text-to-speech","text":"I wanted to receive voice announcements for my smart home in Ukrainian. Fortunately, Google Translate TTS supports voice generation for the Ukrainian language. tts : - platform : google_translate service_name : google_say language : uk # Ukrainian base_url : !secret external_url This will generate phrases and send them to any speaker to play.","title":"Text to Speech"},{"location":"home-assistant/speech/#announcements","text":"I built a nice announcements script for myself. I use it like this: service : script.announcement data : # Speak on smart speakers speak : true # Send notifications on devices notify : true # Title for notification title : '\u041c\u0438\u0442\u0442\u044f \u0430\u0432\u0442\u043e \ud83d\ude98\u2600\ufe0f' # Opening phrases greetings : - '\u041d\u0430\u0439\u0431\u043b\u0438\u0436\u0447\u0438\u043c\u0438 \u0434\u043d\u044f\u043c\u0438 \u043e\u0447\u0456\u043a\u0443\u0454\u0442\u044c\u0441\u044f \u0445\u043e\u0440\u043e\u0448\u0430 \u043f\u043e\u0433\u043e\u0434\u0430.' - '\u0425\u043e\u0440\u043e\u0448\u0430 \u043f\u043e\u0433\u043e\u0434\u0430 \u043d\u0430\u0439\u0431\u043b\u0438\u0436\u0447\u0456 7 \u0434\u043d\u0456\u0432.' - '\u041f\u0440\u043e\u0433\u043d\u043e\u0437\u0443\u0454\u0442\u044c\u0441\u044f \u0445\u043e\u0440\u043e\u0448\u0430 \u043f\u043e\u0433\u043e\u0434\u0430!' # Main phrases messages : - '\u0414\u043e\u0440\u0435\u0447\u043d\u043e \u043f\u043e\u043c\u0438\u0442\u0438 \u043c\u0430\u0448\u0438\u043d\u0443.' - '\u0412\u0430\u0440\u0442\u043e \u043f\u043e\u0457\u0445\u0430\u0442\u0438 \u043d\u0430 \u0430\u0432\u0442\u043e\u043c\u0438\u0439\u043a\u0443.' - '\u0412\u0434\u0430\u043b\u0438\u0439 \u0447\u0430\u0441, \u0449\u043e\u0431 \u043f\u043e\u043c\u0438\u0442\u0438 \u0430\u0432\u0442\u043e.' # Additional data for notifications # Categories or page to open on notification opening notify_data : url : /lovelace/car This script will generate a unique announcement using random phrases from greetings and messages . The generated phrase will be spoken on smart speakers and sent as a notification to the phones. I can avoid speaking or notifying via speak and notify flags accordingly. notify_data helps to pass notification categories for actionable notifications or url to open when I click on this notification. Speech Scripts","title":"Announcements"},{"location":"home-assistant/speech/#do-not-disturb-flow","text":"It would be annoying to get a speech announcement in the middle of the night or a working meeting. That's why I built Do Not Disturb mode. Do Not Disturb is just automation that: Sets the volume of smarts speakers Turns on/off silence modes for fans Turns on/off led indicators Stops/starts voice announcements \u2026 based on the current time of day (sleeping or activity time) and a switch, I can toggle whenever I want. Do Not Disturb Automations","title":"Do Not Disturb Flow"},{"location":"home-assistant/vacuum-setup/","text":"Vacuum Setup \u00b6 I have a Roborock S5 Max vacuum robot. It's paired with Home Assistant using built-in Xiaomi Miio integration . In order to get this device working with Home Assistant, you must obtain an access token, which is a bit tricky. Fortunately, there's a guide on how to get this token . I used a vacuum-card I built myself for controlling my vacuum and lovelace-xiaomi-vacuum-map-card for displaying a live map. You can find the latest state of my vacuum setup here: Automations Scripts Asking to start cleaning \u00b6 I have a relatively complex set of automation for my vacuum. At first, I just used to start my robot every couple of days. It's not a good approach, because it always starts vacuuming right in the middle of a working call. Over time, I've changed logic to more complex and elegant. Now my vacuum sends an actionable notification asking to start cleaning, based on multiple conditions: Robot is docked. It's a working day. It's a time during working hours. Do Not Disturb mode is off. It's time to clean , meaning: the previous cleaning was too short to clean the whole home, or there was no cleaning in a reasonable period. When I think it's a good time to start cleaning, I press a button in the notification, and the robot starts cleaning. Additionally, the robot starts cleaning every time we leave our home, and it's time to clean . Asking to clean itself \u00b6 I solved this issue by automatically sending it to the trash bin after every 5th cleaning. The tricky part here is to tell the robot where to go. There is an article that helped me solve this issue: How I set up room-cleaning automation with Google Home, Home-Assistant and Xiaomi vacuum cleaner Using the method described in the article, I've found the location of my trash bin. In my case, it's: [ 24500 , 24500 ]; Now I can send the vacuum to this spot in my home, like this: vacuum_maintenance : alias : Vacuum Maintenance icon : mdi:screwdriver sequence : - service : vacuum.send_command entity_id : vacuum.roborock data : command : app_goto_target params : [ 24500 , 24500 ] # Coordinates near the trash bin Cleaning the specific room \u00b6 I made shortcuts for cleaning rooms separately. Here's a guide how to retrieve valid room number: Retrieving room numbers . Here are mine: [ [ 16 , '350001002902' ], // Living Room [ 17 , '350001004993' ], // Bedroom [ 18 , '350001010484' ], // Corridor [ 19 , '350001010483' ], // Bathroom [ 20 , '350001010672' ], // Kitchen ]; Using the first number in these tuples, I can send a vacuum to clean a specific room like this: # Single Room vacuum_clean_kitchen : alias : Vacuum Clean Kitchen icon : mdi:silverware-fork-knife sequence : - service : vacuum.send_command data : entity_id : vacuum.roborock command : app_segment_clean params : [ 20 ] # Multiple rooms vacuum_clean_living_room : alias : Vacuum Clean Living Room icon : mdi:sofa sequence : - service : vacuum.send_command data : entity_id : vacuum.roborock command : app_segment_clean params : [ 16 , 20 ]","title":"Vacuum Setup"},{"location":"home-assistant/vacuum-setup/#vacuum-setup","text":"I have a Roborock S5 Max vacuum robot. It's paired with Home Assistant using built-in Xiaomi Miio integration . In order to get this device working with Home Assistant, you must obtain an access token, which is a bit tricky. Fortunately, there's a guide on how to get this token . I used a vacuum-card I built myself for controlling my vacuum and lovelace-xiaomi-vacuum-map-card for displaying a live map. You can find the latest state of my vacuum setup here: Automations Scripts","title":"Vacuum Setup"},{"location":"home-assistant/vacuum-setup/#asking-to-start-cleaning","text":"I have a relatively complex set of automation for my vacuum. At first, I just used to start my robot every couple of days. It's not a good approach, because it always starts vacuuming right in the middle of a working call. Over time, I've changed logic to more complex and elegant. Now my vacuum sends an actionable notification asking to start cleaning, based on multiple conditions: Robot is docked. It's a working day. It's a time during working hours. Do Not Disturb mode is off. It's time to clean , meaning: the previous cleaning was too short to clean the whole home, or there was no cleaning in a reasonable period. When I think it's a good time to start cleaning, I press a button in the notification, and the robot starts cleaning. Additionally, the robot starts cleaning every time we leave our home, and it's time to clean .","title":"Asking to start cleaning"},{"location":"home-assistant/vacuum-setup/#asking-to-clean-itself","text":"I solved this issue by automatically sending it to the trash bin after every 5th cleaning. The tricky part here is to tell the robot where to go. There is an article that helped me solve this issue: How I set up room-cleaning automation with Google Home, Home-Assistant and Xiaomi vacuum cleaner Using the method described in the article, I've found the location of my trash bin. In my case, it's: [ 24500 , 24500 ]; Now I can send the vacuum to this spot in my home, like this: vacuum_maintenance : alias : Vacuum Maintenance icon : mdi:screwdriver sequence : - service : vacuum.send_command entity_id : vacuum.roborock data : command : app_goto_target params : [ 24500 , 24500 ] # Coordinates near the trash bin","title":"Asking to clean itself"},{"location":"home-assistant/vacuum-setup/#cleaning-the-specific-room","text":"I made shortcuts for cleaning rooms separately. Here's a guide how to retrieve valid room number: Retrieving room numbers . Here are mine: [ [ 16 , '350001002902' ], // Living Room [ 17 , '350001004993' ], // Bedroom [ 18 , '350001010484' ], // Corridor [ 19 , '350001010483' ], // Bathroom [ 20 , '350001010672' ], // Kitchen ]; Using the first number in these tuples, I can send a vacuum to clean a specific room like this: # Single Room vacuum_clean_kitchen : alias : Vacuum Clean Kitchen icon : mdi:silverware-fork-knife sequence : - service : vacuum.send_command data : entity_id : vacuum.roborock command : app_segment_clean params : [ 20 ] # Multiple rooms vacuum_clean_living_room : alias : Vacuum Clean Living Room icon : mdi:sofa sequence : - service : vacuum.send_command data : entity_id : vacuum.roborock command : app_segment_clean params : [ 16 , 20 ]","title":"Cleaning the specific room"},{"location":"software/ad-blocking/","text":"Ad Blocking \u00b6 Pi-hole is a powerful network-wide ads & trackers blocking DNS server. Once it's set up, it'll cover all home devices, so there's no need to install any client-side software for that. Why Pi-hole? The have well supported docker image and they also have very broad community. Every aspect is well documented, so it's much easier to fix stuff when something goes wrong. Note Pi-hole blocks requests. This means it can break some websites sometimes. Warning On Ubuntu, there's an issue with systemd-resolved consuming port 53 , which is required for AdGuard. I've made a script smart-home fix-systemd-resolved that automatically fixes that issue. Ad Blocking List \u00b6 Here are ad-blocking lists I use: Every green list on firebog.net Malware Domain List https://www.malwaredomainlist.com/hostslist/hosts.txt NoTracking List https://raw.githubusercontent.com/notracking/hosts-blocklists/master/adblock/adblock.txt YouTube Ads DNS https://raw.githubusercontent.com/kboghdady/youTube_ads_4_pi-hole/master/youtubelist.txt Mobile Ads Filter https://filters.adtidy.org/extension/chromium/filters/11.txt Annoyances Filter https://filters.adtidy.org/extension/chromium/filters/14.txt Russian Ad Filter https://filters.adtidy.org/extension/chromium/filters/1.txt Safari Filter https://filters.adtidy.org/extension/chromium/filters/11.txt Prior ard \u00b6 Caution Previously, I used AdGuard Home to blocks advertisements. AdGuard is a Russian company, and this opens security concerns. Though it's legally registered in Cyprus, most of its developers work from Russian offices. After Russian invasion in Ukraine I decied to move away from AdGuard. I was using AdGuard Home as my primary ad-blocking solution. AdGuard is a DNS-based ad-blocking tool that checks and blocks requests to advertisement domains. There is a Docker container for AdGuard Home . However, make sure your Internet provider allows custom DNS. My provider was blocking this, and I spend a lot of time trying to figure out what's wrong.","title":"Ad-Blocking"},{"location":"software/ad-blocking/#ad-blocking","text":"Pi-hole is a powerful network-wide ads & trackers blocking DNS server. Once it's set up, it'll cover all home devices, so there's no need to install any client-side software for that. Why Pi-hole? The have well supported docker image and they also have very broad community. Every aspect is well documented, so it's much easier to fix stuff when something goes wrong. Note Pi-hole blocks requests. This means it can break some websites sometimes. Warning On Ubuntu, there's an issue with systemd-resolved consuming port 53 , which is required for AdGuard. I've made a script smart-home fix-systemd-resolved that automatically fixes that issue.","title":"Ad Blocking"},{"location":"software/ad-blocking/#ad-blocking-list","text":"Here are ad-blocking lists I use: Every green list on firebog.net Malware Domain List https://www.malwaredomainlist.com/hostslist/hosts.txt NoTracking List https://raw.githubusercontent.com/notracking/hosts-blocklists/master/adblock/adblock.txt YouTube Ads DNS https://raw.githubusercontent.com/kboghdady/youTube_ads_4_pi-hole/master/youtubelist.txt Mobile Ads Filter https://filters.adtidy.org/extension/chromium/filters/11.txt Annoyances Filter https://filters.adtidy.org/extension/chromium/filters/14.txt Russian Ad Filter https://filters.adtidy.org/extension/chromium/filters/1.txt Safari Filter https://filters.adtidy.org/extension/chromium/filters/11.txt","title":"Ad Blocking List"},{"location":"software/ad-blocking/#prior-ard","text":"Caution Previously, I used AdGuard Home to blocks advertisements. AdGuard is a Russian company, and this opens security concerns. Though it's legally registered in Cyprus, most of its developers work from Russian offices. After Russian invasion in Ukraine I decied to move away from AdGuard. I was using AdGuard Home as my primary ad-blocking solution. AdGuard is a DNS-based ad-blocking tool that checks and blocks requests to advertisement domains. There is a Docker container for AdGuard Home . However, make sure your Internet provider allows custom DNS. My provider was blocking this, and I spend a lot of time trying to figure out what's wrong.","title":"Prior ard"},{"location":"software/docker/","text":"Docker Containers \u00b6 Portainer CE \u00b6 Portainer is a lightweight management UI that allows easy Docker management. I use it for restarting, stoping, killing docker containers. I can check logs, ports, statistics. This is my primary tool, that replaces Home Assistant Supervisor. Home Assistant \u00b6 Home Assistant is an open-source home automation platform that puts local control and privacy first. This is the heart of my smart home. Home Assistant powers my home automation binds my devices together, passes them to Google Home and HomeKit, etc. You can read more about it in Home Assistant section of this documentation. Mosquitto \u00b6 Eclipse Mosquitto is lightweight and is suitable for use on all devices from low power single board computers to full servers. In my case, this is an MQTT broker (basically, a man in the middle) between Home Assistant MQTT integration and Zigbee2MQTT container. This is necessary to incorporate my Zigbee devices into my smart home. zigbee2mqtt \u00b6 zigbee2mqtt is a container for connecting Zigbee devices without proprietary Zigbee bridges. It bridges events and allows controlling Zigbee devices via MQTT. In my case, it bridges my Zigbee devices to Home Assistant via CC2531 sniffer. You can read more about it in the Hardware section . ESPHome \u00b6 ESPHome is a system to control ESP8266/ESP32 devices by simple and powerful configuration files and control them remotely through Home Automation systems. I use ESPHome for connecting and controlling my Midea AC remotely. Duplicati \u00b6 Duplicati is a backup software to store encrypted backups online. It works standard protocols like FTP or SSH and cloud services. I use Duplicati as a replacement for Supervisor's Snapshots . It allows to schedule incremental backups, encrypt them, upload to cloud services (Google Drive, Dropbox). Additionally, it gives an ability to restore granularly (only specified files or folders). MariaDB \u00b6 MariaDB is a high-performing open-source relational database, forked from MySQL. Long story short, it's a fast, light, and backward compatible with MySQL database solution. I use it as a SQL database for my smart home. This is used by Nginx Proxy Manager and Umami . Adminer \u00b6 Adminer (formerly phpMinAdmin) is a full-featured database management tool written in PHP. It's a dead-simple UI for my MariaDB database . Nginx Proxy Manager \u00b6 Nginx Proxy Manager is a Docker container for managing Nginx proxy hosts with a simple, powerful interface. This allows me to easily expose services from my local network to the internet. It automatically requests, invalidates, and renews SSL certificates from Let's Encrypt . AirConnect \u00b6 AirConnect is a simple tool to make UPnP/Sonos & Chromecast devices available via AirPlay. Samba \u00b6 Samba Docker container allows me to share folders from my machine as Samba volumes. I use it to expose my home config folder ( smart-home ) and my media vault ( media ). Pi-hole \u00b6 Pi-hole is a powerful network-wide ads & trackers blocking DNS server. Once it's set up, it'll cover all home devices, so there's no need to install any client-side software for that. You can read more about it in a section about Ad-Blocking . Note Previously, I used AdGuard Home to blocks advertisements. AdGuard is a company founded and developed by Russians. After Russian invasion in Ukraine I decied to move away from AdGuard. Plex \u00b6 Plex Media Server organizes video, music, and photos from personal media libraries and streams them to smart TVs, streaming boxes, and mobile devices. Basically, this is a self-hosted Netflix. Plex helps me expose and manage media files from the hard drive wired to Raspberry Pi . It finds localized metadata for my media: descriptions, reviews, posters, and soundtracks. Media is downloaded via Transmission . Transmission \u00b6 Transmission is a popular BitTorrent client. It can be hosted as a Docker container \u2014 that's exactly what I did. I use it for downloading media to my hard drive . Umami \u00b6 Umami is self-hosted analytics for my websites. Simple although completely fits my needs. Note Official images does not support ARM architectures . I've made my own Dockerfile that builds an image right on my Raspberry Pi. Bitwarden \u00b6 Bitwarden is an open-source password manager that can be self-hosted. I'm using Vaultwarden , which is an unofficial Bitwarden client written in Rust. Vaultwarden is especially useful for low powerful machines, like Raspberry Pi.","title":"Docker Containers"},{"location":"software/docker/#docker-containers","text":"","title":"Docker Containers"},{"location":"software/docker/#portainer-ce","text":"Portainer is a lightweight management UI that allows easy Docker management. I use it for restarting, stoping, killing docker containers. I can check logs, ports, statistics. This is my primary tool, that replaces Home Assistant Supervisor.","title":"Portainer CE"},{"location":"software/docker/#home-assistant","text":"Home Assistant is an open-source home automation platform that puts local control and privacy first. This is the heart of my smart home. Home Assistant powers my home automation binds my devices together, passes them to Google Home and HomeKit, etc. You can read more about it in Home Assistant section of this documentation.","title":"Home Assistant"},{"location":"software/docker/#mosquitto","text":"Eclipse Mosquitto is lightweight and is suitable for use on all devices from low power single board computers to full servers. In my case, this is an MQTT broker (basically, a man in the middle) between Home Assistant MQTT integration and Zigbee2MQTT container. This is necessary to incorporate my Zigbee devices into my smart home.","title":"Mosquitto"},{"location":"software/docker/#zigbee2mqtt","text":"zigbee2mqtt is a container for connecting Zigbee devices without proprietary Zigbee bridges. It bridges events and allows controlling Zigbee devices via MQTT. In my case, it bridges my Zigbee devices to Home Assistant via CC2531 sniffer. You can read more about it in the Hardware section .","title":"zigbee2mqtt"},{"location":"software/docker/#esphome","text":"ESPHome is a system to control ESP8266/ESP32 devices by simple and powerful configuration files and control them remotely through Home Automation systems. I use ESPHome for connecting and controlling my Midea AC remotely.","title":"ESPHome"},{"location":"software/docker/#duplicati","text":"Duplicati is a backup software to store encrypted backups online. It works standard protocols like FTP or SSH and cloud services. I use Duplicati as a replacement for Supervisor's Snapshots . It allows to schedule incremental backups, encrypt them, upload to cloud services (Google Drive, Dropbox). Additionally, it gives an ability to restore granularly (only specified files or folders).","title":"Duplicati"},{"location":"software/docker/#mariadb","text":"MariaDB is a high-performing open-source relational database, forked from MySQL. Long story short, it's a fast, light, and backward compatible with MySQL database solution. I use it as a SQL database for my smart home. This is used by Nginx Proxy Manager and Umami .","title":"MariaDB"},{"location":"software/docker/#adminer","text":"Adminer (formerly phpMinAdmin) is a full-featured database management tool written in PHP. It's a dead-simple UI for my MariaDB database .","title":"Adminer"},{"location":"software/docker/#nginx-proxy-manager","text":"Nginx Proxy Manager is a Docker container for managing Nginx proxy hosts with a simple, powerful interface. This allows me to easily expose services from my local network to the internet. It automatically requests, invalidates, and renews SSL certificates from Let's Encrypt .","title":"Nginx Proxy Manager"},{"location":"software/docker/#airconnect","text":"AirConnect is a simple tool to make UPnP/Sonos & Chromecast devices available via AirPlay.","title":"AirConnect"},{"location":"software/docker/#samba","text":"Samba Docker container allows me to share folders from my machine as Samba volumes. I use it to expose my home config folder ( smart-home ) and my media vault ( media ).","title":"Samba"},{"location":"software/docker/#pi-hole","text":"Pi-hole is a powerful network-wide ads & trackers blocking DNS server. Once it's set up, it'll cover all home devices, so there's no need to install any client-side software for that. You can read more about it in a section about Ad-Blocking . Note Previously, I used AdGuard Home to blocks advertisements. AdGuard is a company founded and developed by Russians. After Russian invasion in Ukraine I decied to move away from AdGuard.","title":"Pi-hole"},{"location":"software/docker/#plex","text":"Plex Media Server organizes video, music, and photos from personal media libraries and streams them to smart TVs, streaming boxes, and mobile devices. Basically, this is a self-hosted Netflix. Plex helps me expose and manage media files from the hard drive wired to Raspberry Pi . It finds localized metadata for my media: descriptions, reviews, posters, and soundtracks. Media is downloaded via Transmission .","title":"Plex"},{"location":"software/docker/#transmission","text":"Transmission is a popular BitTorrent client. It can be hosted as a Docker container \u2014 that's exactly what I did. I use it for downloading media to my hard drive .","title":"Transmission"},{"location":"software/docker/#umami","text":"Umami is self-hosted analytics for my websites. Simple although completely fits my needs. Note Official images does not support ARM architectures . I've made my own Dockerfile that builds an image right on my Raspberry Pi.","title":"Umami"},{"location":"software/docker/#bitwarden","text":"Bitwarden is an open-source password manager that can be self-hosted. I'm using Vaultwarden , which is an unofficial Bitwarden client written in Rust. Vaultwarden is especially useful for low powerful machines, like Raspberry Pi.","title":"Bitwarden"},{"location":"software/external-access/","text":"External Access \u00b6 This page describes how I make my smart home accessible from the outer world. Prior art \u00b6 When I was running Home Assistant OS, I had DuckDNS add-on installed. DuckDNS addon is the simplest way to make your HA instance available externally available. It will automatically point your DuckDNS record to your router's IP and request a Let's Encrypt SSL certificate. Downsides of this approach: it is not so convenient when you try to expose more services as subdomains; it exposes your router's IP to everyone on the internet, making you vulnerable to DDoS attacks. That's why I've migrated to a more universal setup. Reverse proxy via Nginx Proxy Manager \u00b6 Nginx Proxy Manager is a Docker container for managing Nginx proxy hosts with a simple, powerful interface. It makes reverse proxying a breeze. It let you configure proxies via UI, making it easy, especially for those who don't have any experience with Nginx. It automatically requests, invalidates, and renews SSL certificates from Let's Encrypt . It blocks common attacks. It provides basic auth for unsecured services. It's simple and powerful. I highly recommend it for your home networks. DNS via Cloudflare \u00b6 Cloudflare is a company that provides free DNS and CDN services. Cloudflare gives lots of useful services for free, and it's easy to set up. It gives a free additional level of security by hiding your router's IP, DDoS mitigation, firewall, access policies, etc. It also improves performance by caching and wide CDN. The most important use-cases for me: hiding my home IP and protecting from common attacks. My main DNS A-type record exposes my Nginx Proxy Manager (ports 80 and 443 ). This name record points to my Home Assistant instance. Other services are exposed via CNAME-type records pointing to the main A-type record. To avoid issues with DDNS, I have enabled Cloudflare integration for Home Assistant for updating my home IP in Cloudflare DNS records. Accessing SSH and Samba via OpenVPN \u00b6 Using Cloudflare makes it impossible to access my home via SSH using a domain name. Additionally, I don't want to expose any other ports on my router except 80 and 443 . My router has a built-in OpenVPN server. When I want to SSH into my home server or open a volume over SSH, I just connect to my home VPN. Once I am connected, I can do everything, like I'm connected to my home WiFi.","title":"External Access"},{"location":"software/external-access/#external-access","text":"This page describes how I make my smart home accessible from the outer world.","title":"External Access"},{"location":"software/external-access/#prior-art","text":"When I was running Home Assistant OS, I had DuckDNS add-on installed. DuckDNS addon is the simplest way to make your HA instance available externally available. It will automatically point your DuckDNS record to your router's IP and request a Let's Encrypt SSL certificate. Downsides of this approach: it is not so convenient when you try to expose more services as subdomains; it exposes your router's IP to everyone on the internet, making you vulnerable to DDoS attacks. That's why I've migrated to a more universal setup.","title":"Prior art"},{"location":"software/external-access/#reverse-proxy-via-nginx-proxy-manager","text":"Nginx Proxy Manager is a Docker container for managing Nginx proxy hosts with a simple, powerful interface. It makes reverse proxying a breeze. It let you configure proxies via UI, making it easy, especially for those who don't have any experience with Nginx. It automatically requests, invalidates, and renews SSL certificates from Let's Encrypt . It blocks common attacks. It provides basic auth for unsecured services. It's simple and powerful. I highly recommend it for your home networks.","title":"Reverse proxy via Nginx Proxy Manager"},{"location":"software/external-access/#dns-via-cloudflare","text":"Cloudflare is a company that provides free DNS and CDN services. Cloudflare gives lots of useful services for free, and it's easy to set up. It gives a free additional level of security by hiding your router's IP, DDoS mitigation, firewall, access policies, etc. It also improves performance by caching and wide CDN. The most important use-cases for me: hiding my home IP and protecting from common attacks. My main DNS A-type record exposes my Nginx Proxy Manager (ports 80 and 443 ). This name record points to my Home Assistant instance. Other services are exposed via CNAME-type records pointing to the main A-type record. To avoid issues with DDNS, I have enabled Cloudflare integration for Home Assistant for updating my home IP in Cloudflare DNS records.","title":"DNS via Cloudflare"},{"location":"software/external-access/#accessing-ssh-and-samba-via-openvpn","text":"Using Cloudflare makes it impossible to access my home via SSH using a domain name. Additionally, I don't want to expose any other ports on my router except 80 and 443 . My router has a built-in OpenVPN server. When I want to SSH into my home server or open a volume over SSH, I just connect to my home VPN. Once I am connected, I can do everything, like I'm connected to my home WiFi.","title":"Accessing SSH and Samba via OpenVPN"},{"location":"software/getting-started/","text":"Getting Started \u00b6 My smart home can be quickly deployed using this guide: Backup everything before performing any action. Backup smart-home folder tar czvf smart-home.tar.gz smart-home Backup Plex libary tar czvf plex.tar.gz ~/Plex Copy archives locally via scp Install Ubuntu Server on card via Raspberry Pi Imager . Plug SSD in Raspberry Pi. Let it a few minutes to start. Connect via ssh using ssh ubuntu@<ip> . You can get the IP in router's connected devices panel. Clone smart-home to home folder or restore from backups Add smart-home binaries to PATH and set SMART_HOME_DIR : echo 'export SMART_HOME_DIR=\"$HOME/smart-home\"' >> ~/.bashrc echo 'export PATH=\"$PATH:$HOME/smart-home/bin\"' >> ~/.bashrc source ~/.bashrc Init smart-home via smart-home init . Fix network manager vie smart-home setup-network . Fix network manager vie smart-home fix-systemd-resolved . Fill secret credentials in .env file. Use smart-home password to generate new passwords. Go to Cockpit dashboard ( https://<ip>: ) and set hostname, mount external storage. Reboot after changes. Spin up containers via smart-home start . This command will pull down images and star up containers.","title":"Getting Started"},{"location":"software/getting-started/#getting-started","text":"My smart home can be quickly deployed using this guide: Backup everything before performing any action. Backup smart-home folder tar czvf smart-home.tar.gz smart-home Backup Plex libary tar czvf plex.tar.gz ~/Plex Copy archives locally via scp Install Ubuntu Server on card via Raspberry Pi Imager . Plug SSD in Raspberry Pi. Let it a few minutes to start. Connect via ssh using ssh ubuntu@<ip> . You can get the IP in router's connected devices panel. Clone smart-home to home folder or restore from backups Add smart-home binaries to PATH and set SMART_HOME_DIR : echo 'export SMART_HOME_DIR=\"$HOME/smart-home\"' >> ~/.bashrc echo 'export PATH=\"$PATH:$HOME/smart-home/bin\"' >> ~/.bashrc source ~/.bashrc Init smart-home via smart-home init . Fix network manager vie smart-home setup-network . Fix network manager vie smart-home fix-systemd-resolved . Fill secret credentials in .env file. Use smart-home password to generate new passwords. Go to Cockpit dashboard ( https://<ip>: ) and set hostname, mount external storage. Reboot after changes. Spin up containers via smart-home start . This command will pull down images and star up containers.","title":"Getting Started"},{"location":"software/ports/","text":"Ports \u00b6 Here's a table of services and ports exposed via docker-compose : Service Exposed port Cockpit 9090 Portainer CE 8000, 9000 Home Assistant 8123 Mosquitto 1888 Zigbee2MQTT 8099 ESPHome 6052 Duplicati 8200 Adminer 8080 Nginx Proxy Manager 80, 443, 8081 Samba 139, 445, 137, 138 Pi-hole 53, 67, 5300 Plex 32400, 3005, 5353, 1900, 8324, 32469, 32410, 32412, 32413, 32414 Transmission 9091, 51413 Umami 8333 Info Some services are exposed as network_mode: host , so some exposed port might not be listed in the table below.","title":"Ports"},{"location":"software/ports/#ports","text":"Here's a table of services and ports exposed via docker-compose : Service Exposed port Cockpit 9090 Portainer CE 8000, 9000 Home Assistant 8123 Mosquitto 1888 Zigbee2MQTT 8099 ESPHome 6052 Duplicati 8200 Adminer 8080 Nginx Proxy Manager 80, 443, 8081 Samba 139, 445, 137, 138 Pi-hole 53, 67, 5300 Plex 32400, 3005, 5353, 1900, 8324, 32469, 32410, 32412, 32413, 32414 Transmission 9091, 51413 Umami 8333 Info Some services are exposed as network_mode: host , so some exposed port might not be listed in the table below.","title":"Ports"},{"location":"software/system/","text":"System Overview \u00b6 This page describes my system setup. Here you can find software I rely on for running my smart home system. Ubuntu Server 20.04 LTS \u00b6 I use Ubuntu as a primary OS for my Raspberry Pi. Ubuntu is a well-maintained Linux distribution with a huge community and large support forums. It officially supports Raspberry Pi and can be easily installed via the official Raspberry Pi Imager. Docker \u00b6 I use Docker for managing all containers in my smart home. Docker allows to encapsulate everything related to a single service within a container. This approach helps to maintain host system clean and manage (start, stop, update and delete) every container separatly. docker-compose helps to describe my whole setup in a single file and manage it with a few commands. Cockpit \u00b6 Cockpit is a web-based graphical interface for servers. Ubuntu is officially supported. This tool let me easily manage my system from web browser: network, external drives, processes and services, system update, etc. smart-home \u00b6 Thi is just a bash script I wrote for personal need. You can find it here . This performs typical tasks I do in my smart home, like bootstraping, controlling server, updating, etc. Prior art \u00b6 Home Assistant OS \u00b6 Previously, I've been using Home Assistant OS installation. Home Assistant OS was installed directly on my Raspberry Pi, controlling every aspect of it. Info Home Assistant OS is nice, especially for newbies. Supervisor handles everything: networking, addons, updates, backups, etc. This lets you start quickly, automate your home, thinking in a safe box. Please, use it if you don't fell confident enough in networking, Linux, and DevOps stuff. The only major downside is an inability to control the system. You cannot host custom software alongside Home Assistant, you don't have full access to your system, you cannot mount external drives. As my knowledge was growing, so was my demands. Raspberry Pi is a very capable device, so I knew I can host more useful things for my home on it. First of all, I wanted to hook up an external hard drive and stream my media via Plex. However, leaving Home Assistant OS means no more benefits of Supervisor . I should manage my system myself: network, updates, backups. This bears more responsibility and headache. I've been developing an alternative solution gradually for a few months, looking for a replacement for every part of the Supervisor's functionality. Then, when I felt confident, I migrated to my new setup. Home Assistant Supervised \u00b6 I was running HA Supervies for a year or so. This worked well for me, though I've decied to move back to Container since it gives much more freedom and control over my system.","title":"System Overview"},{"location":"software/system/#system-overview","text":"This page describes my system setup. Here you can find software I rely on for running my smart home system.","title":"System Overview"},{"location":"software/system/#ubuntu-server-2004-lts","text":"I use Ubuntu as a primary OS for my Raspberry Pi. Ubuntu is a well-maintained Linux distribution with a huge community and large support forums. It officially supports Raspberry Pi and can be easily installed via the official Raspberry Pi Imager.","title":"Ubuntu Server 20.04 LTS"},{"location":"software/system/#docker","text":"I use Docker for managing all containers in my smart home. Docker allows to encapsulate everything related to a single service within a container. This approach helps to maintain host system clean and manage (start, stop, update and delete) every container separatly. docker-compose helps to describe my whole setup in a single file and manage it with a few commands.","title":"Docker"},{"location":"software/system/#cockpit","text":"Cockpit is a web-based graphical interface for servers. Ubuntu is officially supported. This tool let me easily manage my system from web browser: network, external drives, processes and services, system update, etc.","title":"Cockpit"},{"location":"software/system/#smart-home","text":"Thi is just a bash script I wrote for personal need. You can find it here . This performs typical tasks I do in my smart home, like bootstraping, controlling server, updating, etc.","title":"smart-home"},{"location":"software/system/#prior-art","text":"","title":"Prior art"},{"location":"software/system/#home-assistant-os","text":"Previously, I've been using Home Assistant OS installation. Home Assistant OS was installed directly on my Raspberry Pi, controlling every aspect of it. Info Home Assistant OS is nice, especially for newbies. Supervisor handles everything: networking, addons, updates, backups, etc. This lets you start quickly, automate your home, thinking in a safe box. Please, use it if you don't fell confident enough in networking, Linux, and DevOps stuff. The only major downside is an inability to control the system. You cannot host custom software alongside Home Assistant, you don't have full access to your system, you cannot mount external drives. As my knowledge was growing, so was my demands. Raspberry Pi is a very capable device, so I knew I can host more useful things for my home on it. First of all, I wanted to hook up an external hard drive and stream my media via Plex. However, leaving Home Assistant OS means no more benefits of Supervisor . I should manage my system myself: network, updates, backups. This bears more responsibility and headache. I've been developing an alternative solution gradually for a few months, looking for a replacement for every part of the Supervisor's functionality. Then, when I felt confident, I migrated to my new setup.","title":"Home Assistant OS"},{"location":"software/system/#home-assistant-supervised","text":"I was running HA Supervies for a year or so. This worked well for me, though I've decied to move back to Container since it gives much more freedom and control over my system.","title":"Home Assistant Supervised"}]}